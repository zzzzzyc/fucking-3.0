# WebUI 插件

本插件为DG-LAB设备控制服务提供Web用户界面，允许通过浏览器直接控制设备。

## 功能特性

- 直观的Web界面控制DG-LAB设备
- 实时显示设备状态和电池电量
- 独立控制A/B两个通道的强度和波形参数
- 内置多种波形预设
- 实时操作日志
- 自动重连WebSocket

## 使用方法

1. 启动DG-LAB设备控制服务时确保加载此插件：
   ```bash
   python main.py
   ```

2. 插件启动后，使用浏览器访问：
   ```
   http://127.0.0.1:5000
   ```

3. 通过界面连接设备并进行控制

## 波形参数说明

依据DG-LAB V2设备协议，波形控制模块使用X、Y、Z三个参数：

- **X参数**：范围0-31，连续X毫秒发出X个脉冲
- **Y参数**：范围0-1023，X个脉冲过后间隔Y毫秒再发出下一组脉冲
- **Z参数**：范围0-31，控制脉冲宽度，实际脉冲宽度为Z×5μs

典型参数组合示例：
- [1,9,20] - 100Hz频率，宽度100μs，平滑感觉
- [5,95,20] - 10Hz频率，宽度100μs，跳动感觉
- [5,45,20] - 20Hz频率，宽度100μs，中等跳动感

## 预设波形

插件内置多种波形预设：
- **平滑**：平稳连续的脉冲感
- **加速**：逐渐加快的节奏
- **波浪**：强度起伏的波浪感觉
- **强烈**：更强烈的刺激感

## 故障排除

1. 如果无法连接WebSocket，请确认：
   - 主服务正常运行
   - 防火墙未阻止连接
   - 主服务和WebUI地址设置正确

2. 如果无法找到设备：
   - 检查设备是否开启
   - 确认蓝牙连接正常
   - 使用"扫描设备"按钮重新扫描

## 技术信息

- 使用aiohttp提供Web服务
- 使用WebSocket与主服务通信
- 使用原生JavaScript实现前端功能 